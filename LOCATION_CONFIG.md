# GPS 定位觸發系統配置說明

## 📍 功能說明

此系統會在用戶進入任務頁面時自動檢查 GPS 位置，只有在距離指定座標 **50 公尺內**才能開啟任務內容。

## ⚙️ 如何設定 GPS 座標

### 1. 找到實際活動地點的座標

你可以使用以下方式獲取精確的 GPS 座標：

#### 方法一：使用 Google Maps
1. 打開 [Google Maps](https://www.google.com/maps)
2. 找到活動地點
3. 右鍵點擊地點 → 選擇座標
4. 複製緯度和經度（例如：24.8750, 121.8500）

#### 方法二：使用手機定位
1. 到達實際活動地點
2. 使用手機的「指南針」或「地圖」App
3. 查看當前位置的座標

### 2. 修改座標設定

編輯 `location-check.js` 檔案，找到 `TASK_LOCATIONS` 物件：

```javascript
const TASK_LOCATIONS = {
    wave: {
        name: '蜜月灣',
        lat: 24.8750,  // 修改為實際緯度
        lng: 121.8500, // 修改為實際經度
        radius: 50,     // 觸發半徑（公尺）
        description: '📍 蜜月灣・眺望龜山島'
    },
    // ... 其他任務
};
```

### 3. 調整觸發半徑

如果需要調整觸發範圍，修改 `radius` 值（單位：公尺）：
- `50` = 50 公尺範圍
- `100` = 100 公尺範圍
- `200` = 200 公尺範圍

## 🔧 技術細節

### 使用的 API
- **Geolocation API**：瀏覽器內建的地理定位功能
- **Haversine 公式**：計算兩點間距離

### 驗證機制
- 位置驗證成功後，會在 `sessionStorage` 中保存驗證狀態
- 驗證狀態有效期：**5 分鐘**
- 5 分鐘後需要重新驗證

### 瀏覽器權限
- 首次使用時，瀏覽器會請求位置權限
- 用戶必須點擊「允許」才能使用此功能
- 建議在 HTTPS 環境下使用（GitHub Pages 自動提供）

## 📱 使用流程

1. **用戶進入任務頁面**
   - 系統自動檢查是否已驗證（5 分鐘內）

2. **未驗證時**
   - 顯示「需要位置驗證」提示
   - 用戶點擊「開始位置檢查」

3. **位置檢查**
   - 請求瀏覽器位置權限
   - 計算與目標座標的距離
   - 顯示檢查結果

4. **驗證成功**
   - 距離 ≤ 50 公尺：允許進入任務
   - 距離 > 50 公尺：顯示提示，要求前往正確位置

5. **驗證失敗處理**
   - 顯示當前距離
   - 提供「重新檢查」和「返回首頁」選項

## ⚠️ 注意事項

1. **座標精度**
   - GPS 定位精度約為 5-10 公尺
   - 建議設定半徑至少 50 公尺，避免誤判

2. **室內定位**
   - GPS 在室內可能無法使用
   - 建議在戶外開闊地點使用

3. **隱私權**
   - 位置資訊僅在本地處理，不會上傳到伺服器
   - 驗證狀態僅保存在瀏覽器的 sessionStorage

4. **測試模式**
   - 開發測試時，可以暫時註解掉位置檢查
   - 或將 `radius` 設為較大值（如 1000 公尺）

## 🧪 測試建議

1. **開發階段**
   - 先將 `radius` 設為 1000 公尺方便測試
   - 確認功能正常後再改回 50 公尺

2. **實際部署**
   - 到達實際活動地點
   - 使用手機獲取精確座標
   - 更新 `location-check.js` 中的座標
   - 測試驗證功能

## 📝 範例座標（宜蘭海岸）

以下為宜蘭海岸大致座標，請根據實際活動地點調整：

- **蜜月灣**：約 24.875°N, 121.85°E
- **外澳海灘**：約 24.88°N, 121.85°E
- **蘇澳**：約 24.6°N, 121.85°E

## 🔍 除錯

如果位置檢查無法運作：

1. 檢查瀏覽器是否支援 Geolocation API
2. 確認已授予位置權限
3. 檢查是否在 HTTPS 環境（或 localhost）
4. 查看瀏覽器控制台的錯誤訊息
5. 確認座標格式正確（緯度：-90 到 90，經度：-180 到 180）

